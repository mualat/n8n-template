"{\n  \"name\": \"UPNY PPIC 2025 Dashboard\",\n  \"nodes\": [\n    {\n      \"parameters\": {},\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -16,\n        -96\n      ],\n      \"id\": \"b313bc77-b519-4943-a205-758c9b17632c\",\n      \"name\": \"When clicking ‘Execute workflow’\"\n    },\n    {\n      \"parameters\": {\n        \"documentId\": {\n          \"__rl\": true,\n          \"value\": \"1vUoEYxcV7yV7ieC4QkplQDYi9Nhq3OMZ0bAGELmunQ4\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Dataset Penjualan\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1vUoEYxcV7yV7ieC4QkplQDYi9Nhq3OMZ0bAGELmunQ4/edit?usp=drivesdk\"\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"value\": 1036395019,\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Dataset Penjualan\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1vUoEYxcV7yV7ieC4QkplQDYi9Nhq3OMZ0bAGELmunQ4/edit#gid=1036395019\"\n        },\n        \"options\": {}\n      },\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"typeVersion\": 4.7,\n      \"position\": [\n        192,\n        -96\n      ],\n      \"id\": \"60f19e3f-4bc2-42ab-bc7c-90aae9a8365d\",\n      \"name\": \"Get row(s) in sheet\",\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"FyHpApjFN9lVclk6\",\n          \"name\": \"Google Sheets account\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"resource\": \"document\",\n        \"modelId\": {\n          \"__rl\": true,\n          \"value\": \"models/gemini-2.0-flash-lite\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"models/gemini-2.0-flash-lite\"\n        },\n        \"text\": \"Anda adalah analis produksi. Berdasarkan data berikut:\\n{{JSON.stringify($json)}}\\n\\nTUGAS:\\n1. Ambil semua produk dan buat daftar PRODUK UNIK.\\n2. Untuk setiap produk unik, hitung total permintaan per BULAN dari data historis.\\n3. Buat prediksi permintaan 7 hari KE DEPAN berdasarkan rata-rata bulanan.\\n4. Berikan saran jumlah produksi agar stok akhir tetap > 150 unit.\\n\\nATURAN FORMAT OUTPUT:\\n- Output HARUS tetap Key=Value\\n- Tidak boleh ada teks lain\\n- Tidak boleh ada markdown\\n- Tidak boleh ada backtick\\n- Tidak boleh dalam JSON\\n- Gunakan format per produk unik\\n\\nFORMAT WAJIB UNTUK SETIAP PRODUK:\\nNama_Produk=<nama>\\nBulan=<YYYY-MM>\\nPrediksi_Permintaan=<angka>\\nSaran_Produksi=<angka>\\n\\nPisahkan setiap produk dengan baris kosong.\",\n        \"options\": {}\n      },\n      \"type\": \"@n8n/n8n-nodes-langchain.googleGemini\",\n      \"typeVersion\": 1,\n      \"position\": [\n        400,\n        -96\n      ],\n      \"id\": \"30f4b980-36f5-4ade-9855-516c68f9e25b\",\n      \"name\": \"Analyze document\",\n      \"retryOnFail\": true,\n      \"maxTries\": 5,\n      \"waitBetweenTries\": 3000,\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"e1K4oM6Zq3mB6f4h\",\n          \"name\": \"Google Gemini(PaLM) Api account 3\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"6d8669ef-82f8-493b-97e4-d7de1c564da1\",\n              \"name\": \"Nama_Produk\",\n              \"value\": \"={{ $json.content.parts[0].text.match(/Nama_Produk=([^\\\\n]+)/)[1] }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"e5c88e9f-4b97-48f8-9cdf-d3b5c63a8e31\",\n              \"name\": \"Bulan\",\n              \"value\": \"={{ $json.content.parts[0].text.match(/Bulan=([0-9\\\\-]+)/)[1] }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"4a5c15a1-f038-4aa8-932b-10a2b116a5ee\",\n              \"name\": \"Prediksi_Permintaan\",\n              \"value\": \"={{ $json.content.parts[0].text.match(/Prediksi_Permintaan=(\\\\d+)/)[1] }}\",\n              \"type\": \"number\"\n            },\n            {\n              \"id\": \"3b58cbdc-618d-4de0-8b08-96b6c39f6951\",\n              \"name\": \"Saran_Produksi\",\n              \"value\": \"={{ $json.content.parts[0].text.match(/Saran_Produksi=(\\\\d+)/)[1] }}\",\n              \"type\": \"number\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        608,\n        -96\n      ],\n      \"id\": \"f104bd70-557c-4d39-9e62-26e4c114fbb9\",\n      \"name\": \"JSON\"\n    },\n    {\n      \"parameters\": {\n        \"jsCode\": \"const data = items.map(i => i.json);\\n\\nconst grouped = {};\\n\\nfor (const row of data) {\\n  const key = `${row.Nama_Produk}-${row.Bulan}`;\\n  \\n  if (!grouped[key]) {\\n    grouped[key] = {\\n      Nama_Produk: row.Nama_Produk,\\n      Bulan: row.Bulan,\\n      Prediksi_Permintaan: 0,\\n      Saran_Produksi: 0\\n    };\\n  }\\n\\n  grouped[key].Prediksi_Permintaan += Number(row.Prediksi_Permintaan);\\n  grouped[key].Saran_Produksi += Number(row.Saran_Produksi);\\n}\\n\\n// Convert to n8n items\\nreturn Object.values(grouped).map(r => ({ json: r }));\"\n      },\n      \"type\": \"n8n-nodes-base.code\",\n      \"typeVersion\": 2,\n      \"position\": [\n        816,\n        -96\n      ],\n      \"id\": \"a413e1d1-1c64-4666-a113-a21cea401dd8\",\n      \"name\": \"Format Data\"\n    },\n    {\n      \"parameters\": {\n        \"assignments\": {\n          \"assignments\": [\n            {\n              \"id\": \"82f85bf7-4ce5-45f1-8b87-85c8348d89e3\",\n              \"name\": \"Nama_Produk\",\n              \"value\": \"={{ $json.Nama_Produk }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"7a6257b8-b736-432d-85fa-81513ea8906c\",\n              \"name\": \"Bulan\",\n              \"value\": \"={{ $json.Bulan }}\",\n              \"type\": \"string\"\n            },\n            {\n              \"id\": \"0c459b41-0899-46ad-a1b8-0a1b43a384e4\",\n              \"name\": \"Prediksi_Permintaan\",\n              \"value\": \"={{ $json.Prediksi_Permintaan }}\",\n              \"type\": \"number\"\n            },\n            {\n              \"id\": \"c2f433a7-fdf9-4caa-958d-54661db0d7c6\",\n              \"name\": \"Saran_Produksi\",\n              \"value\": \"={{ $json.Saran_Produksi }}\",\n              \"type\": \"number\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"type\": \"n8n-nodes-base.set\",\n      \"typeVersion\": 3.4,\n      \"position\": [\n        1024,\n        -96\n      ],\n      \"id\": \"31b6db43-3f07-440e-9e8a-5fb54365ff23\",\n      \"name\": \"Edit Fields\"\n    },\n    {\n      \"parameters\": {\n        \"resource\": \"databasePage\",\n        \"databaseId\": {\n          \"__rl\": true,\n          \"value\": \"2ac6e2bf-2b95-8029-9b9f-d7e4cee9574f\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Dashboard Stok Barang\",\n          \"cachedResultUrl\": \"https://www.notion.so/2ac6e2bf2b9580299b9fd7e4cee9574f\"\n        },\n        \"propertiesUi\": {\n          \"propertyValues\": [\n            {\n              \"key\": \"Nama|title\",\n              \"title\": \"={{ $json.Nama_Produk }}\"\n            },\n            {\n              \"key\": \"Bulan|date\",\n              \"date\": \"={{ $json.Bulan }}-01\"\n            },\n            {\n              \"key\": \"Prediksi|number\",\n              \"numberValue\": \"={{ $json.Prediksi_Permintaan }}\"\n            },\n            {\n              \"key\": \"Saran|number\",\n              \"numberValue\": \"={{ $json.Saran_Produksi }}\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"type\": \"n8n-nodes-base.notion\",\n      \"typeVersion\": 2.2,\n      \"position\": [\n        1232,\n        -96\n      ],\n      \"id\": \"5ba82a72-a648-4c21-a982-095f2268d900\",\n      \"name\": \"Create a database page\",\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"vS5e7HHL3zMnP5md\",\n          \"name\": \"Notion account\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"jsCode\": \"// items = data dari input (array)\\nconst data = items.map(item => item.json);\\n\\nlet message = `*LAPORAN PRODUK BULAN 2025-08*\\\\n\\\\n`;\\n\\nfor (const row of data) {\\n  message += `*${row.Nama_Produk}*\\\\n`;\\n  message += `• Prediksi Permintaan: *${row.Prediksi_Permintaan}*\\\\n`;\\n  message += `• Saran Produksi: *${row.Saran_Produksi}*\\\\n\\\\n`;\\n}\\n\\nreturn [{\\n  json: {\\n    text: message.trim()\\n  }\\n}];\"\n      },\n      \"type\": \"n8n-nodes-base.code\",\n      \"typeVersion\": 2,\n      \"position\": [\n        1248,\n        112\n      ],\n      \"id\": \"641426cc-705e-4cff-a1b7-dbbcc8463b69\",\n      \"name\": \"Format Telegram\"\n    },\n    {\n      \"parameters\": {\n        \"chatId\": \"601447657\",\n        \"text\": \"={{ $json.text }}\",\n        \"additionalFields\": {}\n      },\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"typeVersion\": 1.2,\n      \"position\": [\n        1456,\n        112\n      ],\n      \"id\": \"0e8c3553-d867-4c98-9f88-a72735412ed7\",\n      \"name\": \"Send a text message\",\n      \"webhookId\": \"e59e650f-1cc1-4477-86d1-c73c1d40250c\",\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"2xcPdcYnFzSGTUMO\",\n          \"name\": \"Telegram account\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"jsCode\": \"// items = data dari input (array)\\nconst data = items.map(item => item.json);\\n\\nlet message = `\\n<h2 style=\\\"font-family:Arial; color:#1a73e8;\\\">Laporan Produk Bulan 2025-08</h2>\\n<table style=\\\"border-collapse:collapse; width:100%; font-family:Arial; margin-top:10px;\\\">\\n  <tr style=\\\"background:#f1f3f4;\\\">\\n    <th style=\\\"border:1px solid #ccc; padding:8px; text-align:left;\\\">Nama Produk</th>\\n    <th style=\\\"border:1px solid #ccc; padding:8px; text-align:left;\\\">Prediksi Permintaan</th>\\n    <th style=\\\"border:1px solid #ccc; padding:8px; text-align:left;\\\">Saran Produksi</th>\\n  </tr>\\n`;\\n\\nfor (const row of data) {\\n  message += `\\n  <tr>\\n    <td style=\\\"border:1px solid #ccc; padding:8px;\\\">${row.Nama_Produk}</td>\\n    <td style=\\\"border:1px solid #ccc; padding:8px;\\\">${row.Prediksi_Permintaan}</td>\\n    <td style=\\\"border:1px solid #ccc; padding:8px;\\\">${row.Saran_Produksi}</td>\\n  </tr>\\n  `;\\n}\\n\\nmessage += `</table>`;\\n\\nreturn [{\\n  json: {\\n    html: message.trim()\\n  }\\n}];\"\n      },\n      \"type\": \"n8n-nodes-base.code\",\n      \"typeVersion\": 2,\n      \"position\": [\n        1248,\n        288\n      ],\n      \"id\": \"fa7619ab-4855-4236-acd1-6b6ed40ac986\",\n      \"name\": \"Format GMAIL\"\n    },\n    {\n      \"parameters\": {\n        \"sendTo\": \"nocturnailed.team@gmail.com\",\n        \"subject\": \"Laporan Data Barang\",\n        \"message\": \"={{ $json.html }}\",\n        \"options\": {}\n      },\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"typeVersion\": 2.1,\n      \"position\": [\n        1456,\n        288\n      ],\n      \"id\": \"c51adc6c-1b12-423e-adb3-4e67742d5f65\",\n      \"name\": \"Send a message\",\n      \"webhookId\": \"0b3edbaa-057f-4dc9-a2d7-bd52f3e15799\",\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"S5V1x3Zm8M1ZoprZ\",\n          \"name\": \"Gmail account\"\n        }\n      }\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"When clicking ‘Execute workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get row(s) in sheet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get row(s) in sheet\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Analyze document\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Analyze document\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"JSON\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"JSON\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Format Data\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Format Data\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Edit Fields\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Edit Fields\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Create a database page\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Format Telegram\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Format GMAIL\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Format Telegram\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send a text message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Send a text message\": {\n      \"main\": [\n        []\n      ]\n    },\n    \"Format GMAIL\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send a message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  },\n  \"active\": false,\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"8c441e44-be55-425f-b629-46c9469d4ffc\",\n  \"meta\": {\n    \"templateCredsSetupCompleted\": true,\n    \"instanceId\": \"0897bb5071ee5f1fe4e60e34ffffe368010d8941696683f7174d283a2d25fa12\"\n  },\n  \"id\": \"Awi8FGXxVM2oKS6O\",\n  \"tags\": []\n}"
