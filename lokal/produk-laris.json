"{\n  \"name\": \"Produk Laris dengan Google Sheet\",\n  \"nodes\": [\n    {\n      \"parameters\": {},\n      \"type\": \"n8n-nodes-base.manualTrigger\",\n      \"typeVersion\": 1,\n      \"position\": [\n        -16,\n        -96\n      ],\n      \"id\": \"3cff4c6f-18d2-4d28-9d46-b8d1c90b3dfe\",\n      \"name\": \"When clicking ‘Execute workflow’\"\n    },\n    {\n      \"parameters\": {\n        \"documentId\": {\n          \"__rl\": true,\n          \"value\": \"1KBqfOMdfnM7KcB3mhdF2wz16KXzgaIRl2CSNfWZD71E\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Online Sales Data\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1KBqfOMdfnM7KcB3mhdF2wz16KXzgaIRl2CSNfWZD71E/edit?usp=drivesdk\"\n        },\n        \"sheetName\": {\n          \"__rl\": true,\n          \"value\": 37723377,\n          \"mode\": \"list\",\n          \"cachedResultName\": \"Online Sales Data\",\n          \"cachedResultUrl\": \"https://docs.google.com/spreadsheets/d/1KBqfOMdfnM7KcB3mhdF2wz16KXzgaIRl2CSNfWZD71E/edit#gid=37723377\"\n        },\n        \"options\": {}\n      },\n      \"type\": \"n8n-nodes-base.googleSheets\",\n      \"typeVersion\": 4.7,\n      \"position\": [\n        192,\n        -96\n      ],\n      \"id\": \"1362b135-5276-482c-a755-841bdb01a2dd\",\n      \"name\": \"Get row(s) in sheet\",\n      \"credentials\": {\n        \"googleSheetsOAuth2Api\": {\n          \"id\": \"FyHpApjFN9lVclk6\",\n          \"name\": \"Google Sheets account\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"jsCode\": \"// Ambil semua data dari node sebelumnya\\nconst rows = $input.all();\\n\\n// Object untuk menyimpan hasil merge\\nconst hasil = {};\\n\\nfor (const r of rows) {\\n\\n  // Ambil data yang diperlukan\\n  const nama = r.json[\\\"Product Name\\\"];\\n  const qty = Number(r.json[\\\"Units Sold\\\"]);\\n  const harga = Number(r.json[\\\"Unit Price\\\"]);\\n\\n  // Jika belum ada entri, buat entri baru\\n  if (!hasil[nama]) {\\n    hasil[nama] = {\\n      product: nama,\\n      total_qty: qty,\\n      total_revenue: qty * harga,\\n      // Opsional: simpan harga awal (kalau mau)\\n      average_price: harga \\n    };\\n  } \\n  else {\\n    // Jika sudah ada → merge\\n    hasil[nama].total_qty += qty;\\n    hasil[nama].total_revenue += qty * harga;\\n\\n    // Update average price berdasarkan total revenue & total qty\\n    hasil[nama].average_price =\\n      hasil[nama].total_revenue / hasil[nama].total_qty;\\n  }\\n}\\n\\n// Kembalikan hasil dalam format n8n\\nreturn Object.values(hasil).map(x => ({ json: x }));\"\n      },\n      \"type\": \"n8n-nodes-base.code\",\n      \"typeVersion\": 2,\n      \"position\": [\n        400,\n        -96\n      ],\n      \"id\": \"d9e21ee4-0f96-43ab-93ed-ed71d80e2077\",\n      \"name\": \"Code in JavaScript\"\n    },\n    {\n      \"parameters\": {\n        \"sortFieldsUi\": {\n          \"sortField\": [\n            {\n              \"fieldName\": \"total_qty\",\n              \"order\": \"descending\"\n            },\n            {\n              \"fieldName\": \"total_revenue\",\n              \"order\": \"descending\"\n            }\n          ]\n        },\n        \"options\": {}\n      },\n      \"type\": \"n8n-nodes-base.sort\",\n      \"typeVersion\": 1,\n      \"position\": [\n        608,\n        -96\n      ],\n      \"id\": \"0adc8a3f-70c5-4492-b3bf-d5ded2cf05f9\",\n      \"name\": \"Sort\"\n    },\n    {\n      \"parameters\": {\n        \"maxItems\": 3\n      },\n      \"type\": \"n8n-nodes-base.limit\",\n      \"typeVersion\": 1,\n      \"position\": [\n        816,\n        -96\n      ],\n      \"id\": \"125f9e5e-6d43-4d5b-9476-62b04b0d23a9\",\n      \"name\": \"Limit\"\n    },\n    {\n      \"parameters\": {\n        \"aggregate\": \"aggregateAllItemData\",\n        \"options\": {}\n      },\n      \"type\": \"n8n-nodes-base.aggregate\",\n      \"typeVersion\": 1,\n      \"position\": [\n        1024,\n        -96\n      ],\n      \"id\": \"364c92c2-5215-49ed-b815-dde5988c6c7a\",\n      \"name\": \"Aggregate\"\n    },\n    {\n      \"parameters\": {\n        \"resource\": \"document\",\n        \"modelId\": {\n          \"__rl\": true,\n          \"value\": \"models/gemini-2.5-flash\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"models/gemini-2.5-flash\"\n        },\n        \"text\": \"=Anda adalah seorang analis bisnis. Berdasarkan data penjualan produk berikut: {{ JSON.stringify($json.data) }}, buatkan laporan penjualan harian yang sangat ringkas dan langsung.\\n\\n**Instruksi Pemrosesan:**\\n1. **Konversi Mata Uang:** Asumsikan kurs 1 USD = 15.500 IDR. Konversi semua nilai \\\"total_revenue\\\" ke Rupiah.\\n2. **Format Angka:** Gunakan format mata uang Rupiah yang sesuai (RpX.XXX.XXX,XX) termasuk 2 digit desimal.\\n3. **Gunakan SELURUH data persis dari input** — jangan mengarang, mengganti produk, atau membuat angka baru.\\n\\n**Struktur Output Laporan (WAJIB IKUTI PERSIS):**\\n\\n**Laporan Penjualan Harian**\\n\\n**Analisis Utama:**  \\n1. Sebutkan total pendapatan keseluruhan (dalam Rupiah) dan total kuantitas keseluruhan.  \\n2. Tampilkan daftar lengkap semua produk dalam format:\\n- **Nama Produk:** RpX.XXX.XXX,XX  \\n(dengan nilai pendapatan hasil konversi USD → IDR)  \\n3. Identifikasi produk **teratas** dan **terlemah** berdasarkan pendapatan Rupiah.\\n\\n**Rekomendasi Cepat:**  \\nBerikan **2 rekomendasi strategis spesifik**:\\n- 1 untuk produk terlaris  \\n- 1 untuk produk terlemah\\n\\n**Aturan WAJIB:**  \\n- Tidak boleh menggunakan data selain dari input.  \\n- Tidak boleh mengubah nama produk.  \\n- Tidak boleh membuat asumsi produk lain.  \\n- Jawaban harus langsung laporan — tanpa kata pembuka/penutup.\",\n        \"simplify\": false,\n        \"options\": {}\n      },\n      \"type\": \"@n8n/n8n-nodes-langchain.googleGemini\",\n      \"typeVersion\": 1,\n      \"position\": [\n        1216,\n        -96\n      ],\n      \"id\": \"fb59b4d2-c68b-40a6-8adf-7000e208320e\",\n      \"name\": \"Analyze document\",\n      \"retryOnFail\": true,\n      \"maxTries\": 3,\n      \"waitBetweenTries\": 5000,\n      \"credentials\": {\n        \"googlePalmApi\": {\n          \"id\": \"pOmAghkG79Qy7SDq\",\n          \"name\": \"Google Gemini(PaLM) Api account\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"sendTo\": \"nocturnailed.team@gmail.com\",\n        \"subject\": \"Laporan Produk Laris\",\n        \"message\": \"={{ $json.data }}\",\n        \"options\": {}\n      },\n      \"type\": \"n8n-nodes-base.gmail\",\n      \"typeVersion\": 2.2,\n      \"position\": [\n        1696,\n        -160\n      ],\n      \"id\": \"f7838724-4fb9-40f5-b8d5-b0bd69c77c3a\",\n      \"name\": \"Send a message\",\n      \"webhookId\": \"7da0bb5e-e04c-4d39-a79a-cc7d8e1a1159\",\n      \"credentials\": {\n        \"gmailOAuth2\": {\n          \"id\": \"S5V1x3Zm8M1ZoprZ\",\n          \"name\": \"Gmail account\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"mode\": \"markdownToHtml\",\n        \"markdown\": \"={{ $json.candidates[0].content.parts[0].text }}\",\n        \"destinationKey\": \"=data\",\n        \"options\": {}\n      },\n      \"type\": \"n8n-nodes-base.markdown\",\n      \"typeVersion\": 1,\n      \"position\": [\n        1440,\n        -96\n      ],\n      \"id\": \"b3c31445-cc48-4746-b4fc-36ed561ee13c\",\n      \"name\": \"Markdown\"\n    },\n    {\n      \"parameters\": {\n        \"chatId\": \"601447657\",\n        \"text\": \"={{ $json.clean_text_for_telegram }}\",\n        \"additionalFields\": {}\n      },\n      \"type\": \"n8n-nodes-base.telegram\",\n      \"typeVersion\": 1.2,\n      \"position\": [\n        1776,\n        336\n      ],\n      \"id\": \"794a3aa6-8e2f-4c72-94d4-6435dae14a73\",\n      \"name\": \"Send a text message\",\n      \"webhookId\": \"20a2e216-b04f-472f-891a-4125d60b4a67\",\n      \"credentials\": {\n        \"telegramApi\": {\n          \"id\": \"2xcPdcYnFzSGTUMO\",\n          \"name\": \"Telegram account\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"resource\": \"databasePage\",\n        \"databaseId\": {\n          \"__rl\": true,\n          \"value\": \"2c56e2bf-2b95-80b8-817b-c962ff36dbab\",\n          \"mode\": \"list\",\n          \"cachedResultName\": \"List Produk Laris\",\n          \"cachedResultUrl\": \"https://www.notion.so/2c56e2bf2b9580b8817bc962ff36dbab\"\n        },\n        \"propertiesUi\": {\n          \"propertyValues\": [\n            {\n              \"key\": \"Produk|title\",\n              \"title\": \"={{ $json.product }}\"\n            },\n            {\n              \"key\": \"Jumlah|number\",\n              \"numberValue\": \"={{ $json.total_qty }}\"\n            }\n          ]\n        },\n        \"blockUi\": {\n          \"blockValues\": [\n            {}\n          ]\n        },\n        \"options\": {}\n      },\n      \"type\": \"n8n-nodes-base.notion\",\n      \"typeVersion\": 2.2,\n      \"position\": [\n        816,\n        128\n      ],\n      \"id\": \"76507ef4-31e8-48f3-94db-86c311942996\",\n      \"name\": \"Create a database page\",\n      \"credentials\": {\n        \"notionApi\": {\n          \"id\": \"vS5e7HHL3zMnP5md\",\n          \"name\": \"Notion account\"\n        }\n      }\n    },\n    {\n      \"parameters\": {\n        \"jsCode\": \"// Ganti 'html_content' dengan nama key yang berisi konten HTML Anda.\\nconst html = $input.first().json.data;\\n\\n// Ekspresi reguler untuk menghapus SEMUA tag HTML,\\n// tetapi menjaga teks di dalamnya.\\nconst text = html.replace(/<[^>]*>/g, '');\\n\\n// Opsional: Hapus baris kosong berlebihan atau spasi berlebihan\\nconst cleanText = text.replace(/(\\\\r\\\\n|\\\\n|\\\\r){2,}/gm, '\\\\n\\\\n').trim();\\n\\n// Kembalikan objek baru dengan konten teks yang sudah bersih\\nreturn [\\n  {\\n    json: {\\n      clean_text_for_telegram: cleanText\\n    }\\n  }\\n];\"\n      },\n      \"type\": \"n8n-nodes-base.code\",\n      \"typeVersion\": 2,\n      \"position\": [\n        1600,\n        160\n      ],\n      \"id\": \"af17ef05-e986-47d5-8de9-9aaadc147f48\",\n      \"name\": \"Code in JavaScript1\"\n    }\n  ],\n  \"pinData\": {},\n  \"connections\": {\n    \"When clicking ‘Execute workflow’\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Get row(s) in sheet\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Get row(s) in sheet\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Code in JavaScript\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Code in JavaScript\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Sort\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Sort\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Limit\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Create a database page\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Limit\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Aggregate\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Aggregate\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Analyze document\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Analyze document\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Markdown\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Markdown\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send a message\",\n            \"type\": \"main\",\n            \"index\": 0\n          },\n          {\n            \"node\": \"Code in JavaScript1\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    },\n    \"Code in JavaScript1\": {\n      \"main\": [\n        [\n          {\n            \"node\": \"Send a text message\",\n            \"type\": \"main\",\n            \"index\": 0\n          }\n        ]\n      ]\n    }\n  },\n  \"active\": false,\n  \"settings\": {\n    \"executionOrder\": \"v1\"\n  },\n  \"versionId\": \"fa043186-a0a5-44b1-b3cd-d256f6b51b46\",\n  \"meta\": {\n    \"templateCredsSetupCompleted\": true,\n    \"instanceId\": \"0897bb5071ee5f1fe4e60e34ffffe368010d8941696683f7174d283a2d25fa12\"\n  },\n  \"id\": \"HiyyXEAvcAY4mYyf\",\n  \"tags\": []\n}"
